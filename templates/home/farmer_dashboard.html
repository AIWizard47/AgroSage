{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Farm Management Dashboard</title>
    <meta name="description" content="Comprehensive Farm Management Platform" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary-color: #2e7d32;
        --primary-light: #60ad5e;
        --primary-dark: #005005;
        --secondary-color: #81c784;
        --accent-color: #ffeb3b;
        --text-color: #263238;
        --bg-color: #f5f7fa;
        --card-bg: #ffffff;
        --danger: #d32f2f;
        --warning: #f57c00;
        --success: #388e3c;
        --info: #0288d1;
      }
      
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      
      body {
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        margin: 0;
        padding: 0;
        overflow-x: hidden;
      }
      .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .section-title {
            font-size: 2rem;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            padding-bottom: 1rem;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--primary);
            border-radius: 2px;
        }
        
        .farmer-history-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            max-width: 400px;
            margin: 0 auto;
            animation: fadeIn 0.8s ease-out;
        }
        
        .farmer-history-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(46, 125, 50, 0.15);
        }
        
        .card-image {
            height: 220px;
            overflow: hidden;
            position: relative;
        }
        
        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .farmer-history-card:hover .card-image img {
            transform: scale(1.05);
        }
        
        .category-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: var(--primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 500;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.5s ease-out 0.3s both;
        }
        
        .card-content {
            padding: 1.5rem;
        }
        
        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
            animation: slideUp 0.5s ease-out 0.1s both;
        }
        
        .card-description {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            animation: slideUp 0.5s ease-out 0.2s both;
        }
        
        .card-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
            animation: slideUp 0.5s ease-out 0.3s both;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
        }
        
        .detail-icon {
            width: 24px;
            height: 24px;
            margin-right: 0.5rem;
            color: var(--primary);
        }
        
        .detail-text {
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .detail-value {
            font-weight: 500;
            color: var(--text-dark);
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideUp 0.5s ease-out 0.4s both;
        }
        
        .price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .price-unit {
            font-size: 0.9rem;
            font-weight: 400;
        }
        
        .rating {
            display: flex;
            align-items: center;
            background-color: var(--primary-light);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 30px;
        }
        
        .rating-icon {
            margin-right: 0.3rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1.5rem;
            animation: slideUp 0.5s ease-out 0.5s both;
        }
        
        .btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-icon {
            margin-right: 0.5rem;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Pulse animation for the card */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(46, 125, 50, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(46, 125, 50, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(46, 125, 50, 0);
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .farmer-history-card {
                max-width: 100%;
            }
        }
      h1, h2, h3, h4, h5 {
        font-family: 'Poppins', sans-serif;
      }
      
      .app-container {
        max-width: 1440px;
        margin: 0 auto;
        padding: 0 1rem;
      }
      
      .header {
        background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
        border-radius: 0 0 1.5rem 1.5rem;
        padding: 1.5rem;
        color: white;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        position: relative;
        overflow: hidden;
      }
      
      .header::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
        transform: rotate(30deg);
      }
      
      .header-container {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
      }
      
      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }
      
      .farm-select-search {
        flex: 1;
        max-width: 500px;
      }
      
      .search-container {
        position: relative;
        display: flex;
        align-items: center;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 0.75rem;
        padding: 0.5rem 1rem;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        transition: all 0.3s ease;
      }
      
      .search-container:focus-within {
        background-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5);
      }
      
      .search-icon {
        width: 1.25rem;
        height: 1.25rem;
        color: white;
        margin-right: 0.5rem;
      }
      
      .search-input {
        background: transparent;
        border: none;
        color: white;
        width: 100%;
        font-size: 0.95rem;
        outline: none;
      }
      
      .search-input::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }
      
      .header-actions {
        display: flex;
        gap: 1rem;
      }
      
      .add-farm-button {
        background-color: rgba(255, 255, 255, 0.2);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      .add-farm-button:hover {
        background-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }
      
      .welcome-section {
        padding: 1rem 0;
      }
      
      .welcome-title {
        font-size: 1.75rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      .hand-wave {
        display: inline-block;
        font-size: 1.5rem;
      }
      
      .welcome-text {
        font-size: 1rem;
        opacity: 0.9;
        max-width: 600px;
      }
      
      .main-content {
        padding: 2rem 0;
        display: grid;
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      
      @media (min-width: 1024px) {
        .main-content {
          grid-template-columns: 2fr 1fr;
        }
      }
      
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        gap: 1rem;
      }
      
      .section-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      
      .icon-container {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .weather-icon-container {
        background-color: #bbdefb;
        color: #1565c0;
      }
      
      .section-icon {
        width: 1.5rem;
        height: 1.5rem;
      }
      
      .section-actions {
        display: flex;
        gap: 0.75rem;
      }
      
      .primary-button, .secondary-button {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .primary-button {
        background-color: var(--primary-color);
        color: white;
        border: none;
      }
      
      .primary-button:hover {
        background-color: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      
      .secondary-button {
        background-color: transparent;
        color: var(--primary-color);
        border: 1px solid var(--primary-color);
      }
      
      .secondary-button:hover {
        background-color: rgba(46, 125, 50, 0.1);
        transform: translateY(-2px);
      }
      
      .weather-section, .crop-section, .budget-section, .tasks-section, .map-section {
        background-color: var(--card-bg);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      
      .weather-section:hover, .crop-section:hover, .budget-section:hover, .tasks-section:hover, .map-section:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      }
      
      .weather-content {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      
      @media (min-width: 768px) {
        .weather-content {
          grid-template-columns: 1fr 1fr;
        }
      }
      
      .weather-details {
        background: linear-gradient(135deg, #42a5f5, #1976d2);
        border-radius: 1rem;
        padding: 1.5rem;
        color: white;
        position: relative;
        overflow: hidden;
      }
      
      .weather-details::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 100%;
        height: 100%;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cpath fill='%23ffffff' fill-opacity='0.05' d='M45.1,-76.5C59.2,-69.7,71.8,-59.2,79.6,-45.6C87.4,-32,90.4,-16,89.6,-0.5C88.8,15.1,84.2,30.1,76.1,43.1C68.1,56.1,56.6,67,43.1,74.4C29.6,81.8,14.8,85.7,-0.2,86C-15.2,86.3,-30.4,83,-43.5,75.6C-56.6,68.2,-67.6,56.6,-75.1,43.1C-82.6,29.6,-86.6,14.8,-86.2,0.2C-85.8,-14.3,-81,-28.6,-73.4,-41.8C-65.8,-55,-55.4,-67,-42.8,-73.8C-30.1,-80.5,-15.1,-82,0.6,-83C16.2,-84,32.5,-84.5,45.1,-76.5Z' transform='translate(100 100)'/%3E%3C/svg%3E") no-repeat center center;
        background-size: cover;
        opacity: 0.1;
      }
      
      .weather-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1.5rem;
        position: relative;
        z-index: 1;
      }
      
      .day {
        font-weight: 600;
        margin: 0;
      }
      
      .date {
        opacity: 0.8;
        margin: 0;
      }
      
      .location {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      .location-dot {
        width: 0.5rem;
        height: 0.5rem;
        background-color: #ffeb3b;
        border-radius: 50%;
        box-shadow: 0 0 8px rgba(255, 235, 59, 0.8);
        animation: pulse 2s infinite;
      }
      
      @keyframes pulse {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.5);
          opacity: 0.7;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      
      .weather-stats {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        z-index: 1;
      }
      
      .weather-stat-item {
        text-align: center;
      }
      
      .stat-emoji {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }
      
      .stat-value {
        font-size: 2rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
      }
      
      .stat-text, .stat-label {
        font-size: 0.875rem;
        opacity: 0.9;
      }
      
      .weather-forecast {
        background-color: #f8fafc;
        border-radius: 1rem;
        padding: 1.5rem;
        border: 1px solid #e2e8f0;
      }
      
      .forecast-title {
        font-weight: 600;
        margin-bottom: 1rem;
        color: #334155;
      }
      
      .forecast-items {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 1rem;
      }
      
      .forecast-item {
        text-align: center;
        padding: 0.75rem;
        background-color: white;
        border-radius: 0.75rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s ease;
      }
      
      .forecast-item:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      
      .forecast-day {
        font-size: 0.75rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #475569;
      }
      
      .forecast-emoji {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }
      
      .forecast-temp {
        font-size: 0.875rem;
        font-weight: 500;
        color: #334155;
      }
      
      .crop-section, .map-section {
        grid-column: 1 / -1;
      }
      
      .crop-content {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.5rem;
      }
      
      .crop-card {
        background-color: white;
        border-radius: 1rem;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 1px solid #e2e8f0;
      }
      
      .crop-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }
      
      .crop-image {
        height: 160px;
        background-size: cover;
        background-position: center;
        position: relative;
      }
      
      .crop-image::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 40%;
        background: linear-gradient(to top, rgba(0,0,0,0.4), rgba(0,0,0,0));
      }
      
      .crop-details {
        padding: 1.25rem;
      }
      
      .crop-name {
        font-weight: 600;
        font-size: 1.125rem;
        margin-bottom: 0.5rem;
        color: #1e293b;
      }
      
      .crop-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1rem;
      }
      
      .crop-info-item {
        text-align: center;
      }
      
      .info-label {
        font-size: 0.75rem;
        color: #64748b;
        margin-bottom: 0.25rem;
      }
      
      .info-value {
        font-weight: 500;
        color: #334155;
      }
      
      .crop-progress {
        margin-top: 1rem;
      }
      
      .progress-label {
        display: flex;
        justify-content: space-between;
        font-size: 0.875rem;
        margin-bottom: 0.5rem;
        color: #475569;
      }
      
      .progress-bar {
        height: 0.5rem;
        background-color: #e2e8f0;
        border-radius: 1rem;
        overflow: hidden;
      }
      
      .progress-fill {
        height: 100%;
        border-radius: 1rem;
        transition: width 1s ease-in-out;
      }
      
      .budget-section, .tasks-section {
        height: fit-content;
      }
      
      .budget-content, .tasks-content {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
      }
      
      .budget-card {
        background-color: #f8fafc;
        border-radius: 0.75rem;
        padding: 1.25rem;
        border: 1px solid #e2e8f0;
        transition: transform 0.2s ease;
      }
      
      .budget-card:hover {
        transform: translateY(-4px);
      }
      
      .budget-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      
      .budget-title {
        font-weight: 600;
        color: #334155;
      }
      
      .budget-amount {
        font-weight: 700;
        font-size: 1.25rem;
        color: #0f172a;
      }
      
      .budget-chart {
        height: 180px;
        margin-bottom: 1rem;
        position: relative;
      }
      
      .chart-bars {
        display: flex;
        align-items: flex-end;
        height: 150px;
        gap: 0.5rem;
      }
      
      .chart-bar {
        flex: 1;
        background-color: #e2e8f0;
        border-radius: 0.25rem 0.25rem 0 0;
        position: relative;
      }
      
      .chart-bar-fill {
        position: absolute;
        bottom: 0;
        width: 100%;
        border-radius: 0.25rem 0.25rem 0 0;
        transition: height 1s ease-in-out;
      }
      
      .chart-labels {
        display: flex;
        justify-content: space-between;
        margin-top: 0.5rem;
      }
      
      .chart-label {
        font-size: 0.75rem;
        color: #64748b;
        text-align: center;
        flex: 1;
      }
      
      .budget-legend {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
      }
      
      .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: #475569;
      }
      
      .legend-color {
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
      }
      
      .task-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background-color: #f8fafc;
        border-radius: 0.75rem;
        transition: all 0.2s ease;
        border: 1px solid #e2e8f0;
      }
      
      .task-item:hover {
        background-color: #f1f5f9;
        transform: translateX(4px);
      }
      
      .task-checkbox {
        width: 1.25rem;
        height: 1.25rem;
        border-radius: 50%;
        border: 2px solid #cbd5e1;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        flex-shrink: 0;
        transition: all 0.2s ease;
      }
      
      .task-checkbox:hover {
        border-color: var(--primary-color);
        transform: scale(1.1);
      }
      
      .task-checkbox.checked {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
      }
      
      .task-checkbox.checked::after {
        content: "✓";
        color: white;
        font-size: 0.75rem;
      }
      
      .task-content {
        flex: 1;
      }
      
      .task-title {
        font-weight: 500;
        margin-bottom: 0.25rem;
        color: #334155;
        transition: all 0.2s ease;
      }
      
      .task-due {
        font-size: 0.75rem;
        color: #64748b;
      }
      
      .task-priority {
        padding: 0.25rem 0.5rem;
        border-radius: 1rem;
        font-size: 0.75rem;
        font-weight: 500;
      }
      
      .priority-high {
        background-color: #fee2e2;
        color: #b91c1c;
      }
      
      .priority-medium {
        background-color: #fef3c7;
        color: #92400e;
      }
      
      .priority-low {
        background-color: #dcfce7;
        color: #166534;
      }
      
      .map-container {
        height: 400px;
        border-radius: 0.75rem;
        overflow: hidden;
        position: relative;
      }
      
      .map {
        width: 100%;
        height: 100%;
        background-color: #e2e8f0;
      }
      
      .map-overlay {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background-color: white;
        border-radius: 0.5rem;
        padding: 0.75rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        z-index: 10;
      }
      
      .map-legend {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .map-legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.75rem;
        color: #475569;
      }
      
      .map-legend-color {
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 2px;
      }
      
      .map-controls {
        position: absolute;
        bottom: 1rem;
        left: 1rem;
        display: flex;
        gap: 0.5rem;
        z-index: 10;
      }
      
      .map-control-button {
        width: 2.5rem;
        height: 2.5rem;
        background-color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .map-control-button:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      
      .map-control-icon {
        width: 1.25rem;
        height: 1.25rem;
        color: #475569;
      }
      
      .field-marker {
        position: absolute;
        width: 2rem;
        height: 2rem;
        background-color: rgba(46, 125, 50, 0.8);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: all 0.2s ease;
        z-index: 5;
      }
      
      .field-marker:hover {
        transform: translate(-50%, -50%) scale(1.2);
      }
      
      .field-marker.wheat {
        background-color: rgba(46, 125, 50, 0.8);
      }
      
      .field-marker.corn {
        background-color: rgba(255, 179, 0, 0.8);
      }
      
      .field-marker.soybeans {
        background-color: rgba(46, 125, 50, 0.8);
      }
      
      .field-marker.cotton {
        background-color: rgba(156, 39, 176, 0.8);
      }
      
      .field-tooltip {
        position: absolute;
        background-color: white;
        border-radius: 0.5rem;
        padding: 0.75rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        width: 200px;
        z-index: 20;
        display: none;
      }
      
      .field-tooltip.active {
        display: block;
      }
      
      .tooltip-title {
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #1e293b;
      }
      
      .tooltip-info {
        font-size: 0.875rem;
        color: #475569;
      }
      
      .tooltip-progress {
        margin-top: 0.5rem;
      }
      
      /* Weather alert modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 50;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }
      
      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }
      
      .modal {
        background-color: white;
        border-radius: 1rem;
        padding: 1.5rem;
        width: 100%;
        max-width: 500px;
        transform: translateY(20px);
        opacity: 0;
        transition: all 0.3s ease;
      }
      
      .modal-overlay.active .modal {
        transform: translateY(0);
        opacity: 1;
      }
      
      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }
      
      .modal-title {
        font-weight: 600;
        font-size: 1.25rem;
        color: #1e293b;
      }
      
      .modal-close {
        background: none;
        border: none;
        cursor: pointer;
        color: #64748b;
        transition: color 0.2s ease;
      }
      
      .modal-close:hover {
        color: #1e293b;
      }
      
      .modal-body {
        margin-bottom: 1.5rem;
      }
      
      .form-group {
        margin-bottom: 1rem;
      }
      
      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: #334155;
      }
      
      .form-control {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #cbd5e1;
        border-radius: 0.5rem;
        font-size: 0.95rem;
        transition: border-color 0.2s ease;
      }
      
      .form-control:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(46, 125, 50, 0.2);
      }
      
      .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
      }
      
      /* Animations */
      .animate-slide-up {
        animation: slideUp 0.6s ease-out;
      }
      
      .animate-slide-right {
        animation: slideRight 0.6s ease-out;
      }
      
      .animate-slide-left {
        animation: slideLeft 0.6s ease-out;
      }
      
      .animate-fade-in {
        animation: fadeIn 0.8s ease-out;
      }
      
      .animate-bounce-gentle {
        animation: bounceGentle 2s infinite;
      }
      
      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      
      @keyframes slideRight {
        from {
          transform: translateX(-20px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      @keyframes slideLeft {
        from {
          transform: translateX(20px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      
      @keyframes bounceGentle {
        0%, 100% {
          transform: rotate(0deg);
        }
        25% {
          transform: rotate(15deg);
        }
        75% {
          transform: rotate(-10deg);
        }
      }
      
      /* Responsive adjustments */
      @media (max-width: 768px) {
        .header-top {
          flex-direction: column;
          align-items: stretch;
          gap: 1rem;
        }
        
        .farm-select-search {
          max-width: 100%;
        }
        
        .section-header {
          flex-direction: column;
          align-items: flex-start;
        }
        
        .weather-header {
          flex-direction: column;
          gap: 0.5rem;
        }
        
        .weather-stats {
          flex-direction: column;
          gap: 1rem;
        }
        
        .map-container {
          height: 300px;
        }
      }
    </style>
  </head>

  <body>
    <div class="app-container">
      <header class="header animate-slide-up">
        <div class="header-container">
          <div class="header-top">
            
            <div class="header-actions">
              <button class="add-farm-button" id="addProductBtn" onclick="window.location.href='{%url 'list_item' %}'">
                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
                ADD Product
              </button>
              <button class="add-farm-button" id="guidanceBtn" onclick="window.location.href='{%url 'farmer_guidance' %}'">
                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                AI-Guidance
              </button>
            </div>
          </div>
          
          <div class="welcome-section animate-fade-in">
            <h1 class="welcome-title">
              Welcome Farmer {{name}}! 
              <span class="hand-wave animate-bounce-gentle">👋</span>
            </h1>
            <h1 class="welcome-title">
              Total Farmer earned {{total_amount}}!
              <span class="hand-wave animate-bounce-gentle">💴</span>
            </h1>
            <p class="welcome-text">
              Here's your farm's daily overview at a glance - track weather updates, crop details, and budget insights, all in one place!
            </p>
          </div>
        </div>
      </header>

      {% if market_items %}
  <h2 class="text-2xl font-bold text-green-700 mb-4">Farmer's Listed Products</h2>
  <div class="overflow-x-auto">
    <table class="min-w-full table-auto border border-gray-300 bg-white rounded-lg shadow">
      <thead class="bg-green-600 text-white">
        <tr>
          <th class="px-4 py-2 text-left">Name</th>
          <th class="px-4 py-2 text-left">Image</th>
          <th class="px-4 py-2 text-left">Price (₹/Kg)</th>
          <th class="px-4 py-2 text-left">Weight (Quintal)</th>
          <th class="px-4 py-2 text-left">Rating</th>
          <th class="px-4 py-2 text-left">Description</th>
          <th class="px-4 py-2 text-left">Actions</th>
        </tr>
      </thead>
      <tbody class="text-gray-700">
        {% for item in market_items %}
        <tr class="border-t hover:bg-green-50">
          <td class="px-4 py-2 font-semibold">{{ item.items_name }}</td>
          <td class="px-4 py-2">
            {% if item.item_image %}
              <img src="{{ item.item_image.url }}" alt="{{ item.items_name }}" class="h-16 w-16 object-cover rounded-md">
            {% else %}
              <span class="italic text-gray-400">No Image</span>
            {% endif %}
          </td>
          <td class="px-4 py-2">{{ item.item_price }}</td>
          <td class="px-4 py-2">{{ item.items_weight }}</td>
          <td class="px-4 py-2">{{ item.item_rating }}</td>
          <td class="px-4 py-2">{{ item.items_description|truncatechars:50 }}</td>
          <td class="px-4 py-2">
            <a href="{% url 'product_card' item.id %}" class="text-green-600 hover:underline">View</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endif %}


{% if history %}
  <h2 class="text-2xl font-bold text-green-700 mt-10 mb-4">Farmer Sold Products</h2>
  <div class="overflow-x-auto">
    <table class="min-w-full table-auto border border-gray-300 bg-white rounded-lg shadow">
      <thead class="bg-green-700 text-white">
        <tr>
          <th class="px-4 py-2 text-left">Name</th>
          <th class="px-4 py-2 text-left">Image</th>
          <th class="px-4 py-2 text-left">Category</th>
          <th class="px-4 py-2 text-left">Price (₹/Kg)</th>
          <th class="px-4 py-2 text-left">Weight</th>
          <th class="px-4 py-2 text-left">Rating</th>
          <th class="px-4 py-2 text-left">Location</th>
          <th class="px-4 py-2 text-left">Description</th>
        </tr>
      </thead>
      <tbody class="text-gray-700">
        {% for item in history %}
        <tr class="border-t hover:bg-green-50">
          <td class="px-4 py-2 font-semibold">{{ item.items_name }}</td>
          <td class="px-4 py-2">
            {% if item.item_image %}
              <img src="{{ item.item_image.url }}" alt="{{ item.items_name }}" class="h-16 w-16 object-cover rounded-md">
            {% else %}
              <img src="{% static 'images/placeholder.jpg' %}" alt="No image" class="h-16 w-16 object-cover rounded-md">
            {% endif %}
          </td>
          <td class="px-4 py-2">{{ item.category.name }}</td>
          <td class="px-4 py-2">{{ item.item_price }}</td>
          <td class="px-4 py-2">{{ item.items_weight }}</td>
          <td class="px-4 py-2">{{ item.item_rating }}</td>
          <td class="px-4 py-2">{{ item.location }}</td>
          <td class="px-4 py-2">{{ item.items_description|truncatechars:50 }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endif %}

      

      <main class="main-content">
        <!-- Weather Section -->
        <section class="weather-section animate-slide-right">
          <div class="section-header">
            <div class="section-title">
              <div class="icon-container weather-icon-container">
                <svg class="section-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.4 4.4 0 003 15z" />
                </svg>
              </div>
              <h2>Weather Recommendations</h2>
            </div>
            
              <div class="section-actions">
                <label for="locationSelect" style="margin-right: 10px; font-weight: bold;">Select Location:</label>
                <select id="locationSelect" class="primary-button">
                  <option value="Bhopal">Bhopal</option>
                  <option value="Patna">Patna</option>
                  <option value="Muzaffarpur">Muzaffarpur</option>
                  <option value="Bhagalpur">Bhagalpur</option>
                  <option value="Gaya">Gaya</option>
                  <option value="Dhanbad">Dhanbad</option>
                  <option value="Ranchi">Ranchi</option>
                  <option value="Hazaribagh">Hazaribagh</option>
                </select>
              </div>

          
          <div class="weather-content">
            <div class="weather-details">
              <div class="weather-header">
                <div>
                  <p class="day">SATURDAY</p>
                  <p class="date">02-Nov-2024</p>
                </div>
                <div class="location">
                  <div class="location-dot"></div>
                  <span>Sagarnagar</span>
                </div>
              </div>
              
              <div class="weather-stats">
                <div class="weather-stat-item">
                  <div class="stat-emoji">☁️</div>
                  <div class="stat-text">Mostly Cloudy</div>
                </div>
                
                <div class="weather-stat-item">
                  <div class="stat-value">26°</div>
                  <div class="stat-label">Temperature</div>
                </div>
                
                <div class="weather-stat-item">
                  <div class="stat-value">68%</div>
                  <div class="stat-label">Humidity</div>
                </div>
              </div>
            </div>
            
            <div class="weather-forecast">
              <h3 class="forecast-title">5-Day Forecast</h3>
              <div class="forecast-items">
                <div class="forecast-item">
                  <div class="forecast-day">SUN</div>
                  <div class="forecast-emoji">☀️</div>
                  <div class="forecast-temp">28°</div>
                </div>
                <div class="forecast-item">
                  <div class="forecast-day">MON</div>
                  <div class="forecast-emoji">🌤️</div>
                  <div class="forecast-temp">27°</div>
                </div>
                <div class="forecast-item">
                  <div class="forecast-day">TUE</div>
                  <div class="forecast-emoji">🌧️</div>
                  <div class="forecast-temp">24°</div>
                </div>
                <div class="forecast-item">
                  <div class="forecast-day">WED</div>
                  <div class="forecast-emoji">🌧️</div>
                  <div class="forecast-temp">23°</div>
                </div>
                <div class="forecast-item">
                  <div class="forecast-day">THU</div>
                  <div class="forecast-emoji">⛅</div>
                  <div class="forecast-temp">25°</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Tasks Section -->
        <section class="tasks-section animate-slide-left">
          <div class="section-header">
            <div class="section-title">
              <div class="icon-container" style="background-color: #e8f5e9; color: #2e7d32;">
                <svg class="section-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
              </div>
              <h2>Today's Tasks</h2>
            </div>
            
            <div class="section-actions">
              <button class="primary-button" id="addTaskBtn">
                + Add Task
              </button>
            </div>
          </div>
          
          <div class="tasks-content">
            <div class="task-item">
              <div class="task-checkbox" onclick="toggleTaskComplete(this)"></div>
              <div class="task-content">
                <div class="task-title">Irrigate wheat field</div>
                <div class="task-due" data-original="Due today at 8:00 AM">Due today at 8:00 AM</div>
              </div>
              <div class="task-priority priority-high">High</div>
            </div>
            
            <div class="task-item">
              <div class="task-checkbox" onclick="toggleTaskComplete(this)"></div>
              <div class="task-content">
                <div class="task-title">Apply fertilizer to corn</div>
                <div class="task-due" data-original="Due today at 10:00 AM">Due today at 10:00 AM</div>
              </div>
              <div class="task-priority priority-medium">Medium</div>
            </div>
            
            <div class="task-item">
              <div class="task-checkbox checked" onclick="toggleTaskComplete(this)"></div>
              <div class="task-content">
                <div class="task-title" style="text-decoration: line-through; opacity: 0.7;">Check soil moisture</div>
                <div class="task-due" data-original="Due today at 6:30 AM">Completed at 6:30 AM</div>
              </div>
              <div class="task-priority priority-low">Low</div>
            </div>
            
            <div class="task-item">
              <div class="task-checkbox" onclick="toggleTaskComplete(this)"></div>
              <div class="task-content">
                <div class="task-title">Order new seeds</div>
                <div class="task-due" data-original="Due today at 4:00 PM">Due today at 4:00 PM</div>
              </div>
              <div class="task-priority priority-medium">Medium</div>
            </div>
            
            <div class="task-item">
              <div class="task-checkbox" onclick="toggleTaskComplete(this)"></div>
              <div class="task-content">
                <div class="task-title">Check irrigation system</div>
                <div class="task-due" data-original="Due today at 2:00 PM">Due today at 2:00 PM</div>
              </div>
              <div class="task-priority priority-high">High</div>
            </div>
          </div>
        </section>




    
      
    <script>

      const API_KEY = 'f26cd83e87aa4d4796703795788519d3';
      let LOCATION = document.getElementById('locationSelect').value;

      async function fetchWeather() {
        const currentURL = `https://api.openweathermap.org/data/2.5/weather?q=${LOCATION}&appid=${API_KEY}&units=metric`;
        const forecastURL = `https://api.openweathermap.org/data/2.5/forecast?q=${LOCATION}&appid=${API_KEY}&units=metric`;

        try {
          const [currentRes, forecastRes] = await Promise.all([
            fetch(currentURL),
            fetch(forecastURL)
          ]);

          const currentData = await currentRes.json();
          const forecastData = await forecastRes.json();

          const today = new Date();
          const day = today.toLocaleDateString('en-US', { weekday: 'long' }).toUpperCase();
          const date = today.toISOString().slice(0, 10).split('-').reverse().join('-');

          document.querySelector('.day').textContent = day;
          document.querySelector('.date').textContent = date;
          document.querySelector('.location span').textContent = currentData.name;
          document.querySelector('.stat-text').textContent = currentData.weather[0].description;
          document.querySelector('.stat-emoji').textContent = getWeatherEmoji(currentData.weather[0].main);
          document.querySelector('.stat-value').textContent = `${Math.round(currentData.main.temp)}°`;
          document.querySelectorAll('.stat-value')[1].textContent = `${currentData.main.humidity}%`;

          const forecastContainer = document.querySelector('.forecast-items');
          forecastContainer.innerHTML = '';
          const forecastList = forecastData.list.filter((_, idx) => idx % 8 === 0);

          forecastList.slice(0, 5).forEach(item => {
            const date = new Date(item.dt_txt);
            const day = date.toLocaleDateString('en-US', { weekday: 'short' }).toUpperCase();
            const emoji = getWeatherEmoji(item.weather[0].main);
            const temp = `${Math.round(item.main.temp)}°`;

            forecastContainer.innerHTML += `
              <div class="forecast-item">
                <div class="forecast-day">${day}</div>
                <div class="forecast-emoji">${emoji}</div>
                <div class="forecast-temp">${temp}</div>
              </div>
            `;
          });

        } catch (error) {
          console.error('Weather fetch error:', error);
        }
      }

      function getWeatherEmoji(condition) {
        switch (condition.toLowerCase()) {
          case 'clear': return '☀️';
          case 'clouds': return '☁️';
          case 'rain': return '🌧️';
          case 'thunderstorm': return '⛈️';
          case 'drizzle': return '🌦️';
          case 'snow': return '❄️';
          case 'mist': return '🌫️';
          default: return '⛅';
        }
      }

      document.getElementById('locationSelect').addEventListener('change', function () {
        LOCATION = this.value;
        fetchWeather();
      });

      fetchWeather(); // Initial fetch


      // Current date display
      const updateDate = () => {
        const now = new Date();
        const days = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];
        const day = days[now.getDay()];
        
        const date = now.getDate().toString().padStart(2, '0');
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const year = now.getFullYear();
        
        document.querySelector('.day').textContent = day;
        document.querySelector('.date').textContent = `${date}-${month}-${year}`;
      };
      
      updateDate();
      
      // Task checkbox functionality
      function toggleTaskComplete(checkbox) {
        checkbox.classList.toggle('checked');
        const taskItem = checkbox.closest('.task-item');
        const taskTitle = taskItem.querySelector('.task-title');
        const taskDue = taskItem.querySelector('.task-due');
        
        if (checkbox.classList.contains('checked')) {
          taskTitle.style.textDecoration = 'line-through';
          taskTitle.style.opacity = '0.7';
          const now = new Date();
          const hours = now.getHours();
          const minutes = String(now.getMinutes()).padStart(2, '0');
          const ampm = hours >= 12 ? 'PM' : 'AM';
          const formattedHours = hours % 12 || 12;
          taskDue.textContent = `Completed at ${formattedHours}:${minutes} ${ampm}`;
        } else {
          taskTitle.style.textDecoration = 'none';
          taskTitle.style.opacity = '1';
          taskDue.textContent = taskDue.getAttribute('data-original') || taskDue.textContent;
        }
      }
      
      // Button functionality
      document.getElementById('addProductBtn').addEventListener('click', function() {
        alert('Add Product form will open here');
      });
      
      document.getElementById('guidanceBtn').addEventListener('click', function() {
        alert('Farmer guidance resources will open here');
      });
      
      document.getElementById('addTaskBtn').addEventListener('click', function() {
        alert('Add Task form will open here');
      });
      
      document.getElementById('viewAllCropsBtn').addEventListener('click', function() {
        alert('View all crops page will open here');
      });
      
      document.getElementById('addCropBtn').addEventListener('click', function() {
        alert('Add new crop form will open here');
      });
      
      document.getElementById('fullReportBtn').addEventListener('click', function() {
        alert('Full financial report will open here');
      });
      
      document.getElementById('fullWeatherBtn').addEventListener('click', function() {
        alert('Full weather report will open here');
      });
      
      document.getElementById('mapLayersBtn').addEventListener('click', function() {
        alert('Map layers options will open here');
      });
      
      document.getElementById('fullMapBtn').addEventListener('click', function() {
        alert('Full map view will open here');
      });
      
              // Animation when card comes into view
        document.addEventListener('DOMContentLoaded', function() {
            const card = document.querySelector('.farmer-history-card');
            
            // Function to check if element is in viewport
            function isInViewport(element) {
                const rect = element.getBoundingClientRect();
                return (
                    rect.top >= 0 &&
                    rect.left >= 0 &&
                    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                );
            }
            
            // Add animation class when card is in viewport
            function checkVisibility() {
                if (isInViewport(card)) {
                    card.style.opacity = '1';
                }
            }
            
            // Initial check
            checkVisibility();
            
            // Check on scroll
            window.addEventListener('scroll', checkVisibility);
            
            // Add hover effect for buttons
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                button.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-3px)';
                });
                
                button.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
      
    </script>
</body>
</html>